[gd_scene load_steps=7 format=1]

[ext_resource path="res://R_and_D/paper_prtotype/utils/word_panel.tscn" type="PackedScene" id=1]
[ext_resource path="res://R_and_D/paper_prtotype/img/white_square.png" type="Texture" id=2]
[ext_resource path="res://R_and_D/paper_prtotype/img/notebook_new_words.png" type="Texture" id=3]

[sub_resource type="GDScript" id=24]

resource/name = "notebook_ui"
script/source = "extends Node2D\n\nexport (PackedScene) var word_panel\nexport (NodePath) var root_node\nexport (NodePath) var panel\n\nvar placement_pos = Vector2()\n\nvar word_panel_list = []\n\nvar word_in_focus_counter = 0\n\nfunc _ready():\n\thide()\n\t\n\tif(root_node != null): root_node = get_node(root_node)\n\tif(panel != null): panel = get_node(panel)\n\t\n\t\n\troot_node.connect(\"notebook\",self,\"notebook_state\")\n\tpass\n\nfunc notebook_state():\n\t\n\twords_init()\n\tprint(\"NOTEBOOK ACTIVE\")\n\tshow()\n\t\nfunc words_init():\n\t\n\tvar unproccesed_words = _Player.unproccesed_words\n#\tunproccesed_words = [\"hola\",\"one\",\"two\",\"three\",\"four\"]\n#\tprint(\"THE WORDS: \" + str(unproccesed_words))\n\tfor w in unproccesed_words:\n\t\tvar word = word_panel.instance()\n\t\tpanel.add_child(word)\n\t\tword.set_word_label(w)\n\t\tword.set_pos(placement_pos)\n\t\tplacement_pos.y += 130\n\t\tword_panel_list.append(word)\n\t\tword.control_node = self\n\t\tword.set_name(w)\n\t\tprint(w)\n\tword_panel_list[word_in_focus_counter].set_active(true)\n\tpass\n\t\n\t\nfunc queue_next_panel(word):\n\tvar tmp_atempt\n\t\n\tword.set_active(false)\n\tif(word_in_focus_counter < word_panel_list.size() -1): word_in_focus_counter += 1\n\telse: word_in_focus_counter = 0\n\tword_panel_list[word_in_focus_counter].set_active(true)\n\t\n#\tprint(word.get_name())\n\ttmp_atempt = _Player.check_translation_atempt(word.get_name(),word.translation_atempt)\n\t\n\t\n\tif(tmp_atempt[1] > 0.7):\n\t\t\n\t\tvar conversation = {\n\t\t\t\"is_speach\":true,\n\t\t\t\"callback_end_functions\":[],\n\t\t\t\"spanish_words\":[],\n\t\t\t\"paused_dialog_adress\": null,\n\t\t\t#KEYE\t E = END , speaker, audio clip/time code , dialog, [spanish words]] , function_name, [args]]\n\t\t\t[\'A\',1]:[\'E\', 1 , null , \"I think that is correct\", null,null, null],\n\t\t}\n\t\troot_node.start_conversation([self,self], conversation)\n\t\t\n#\telse:\n#\t\tvar conversation = {\n#\t\t\t\"is_speach\":true,\n#\t\t\t\"callback_end_functions\":[],\n#\t\t\t\"spanish_words\":[],\n#\t\t\t\"paused_dialog_adress\": null,\n#\t\t\t#KEYE\t E = END , speaker, audio clip/time code , dialog, [spanish words]] , function_name, [args]]\n#\t\t\t[\'A\',1]:[\'E\', 1 , null , \"Mhmm, I think I\'ll dobble check this to night\", null,null, null],\n#\t\t}\n\n\n"

[sub_resource type="GDScript" id=25]

resource/name = "word_panel"
script/source = "#\t\t\t\t\tword\?panel\nextends Node2D\n\nexport (NodePath) var word_icon\nexport (NodePath) var root_node\n\nvar control_node\n\nvar word_label setget set_word_label, get_word_label\nvar is_active setget set_active, get_activity\n\nvar translation_atempt\n\nfunc _ready():\n\t\n\tif(root_node != null): root_node = get_node(root_node)\n\tif(word_icon != null): word_icon = get_node(word_icon)\n\tset_active(false)\n\nfunc set_word_label(_word_label):\n\tword_label = _word_label\n\tword_icon.set_word_label(word_label)\n\nfunc get_word_label(): return word_label\n\nfunc set_active(_is_active = false):\n\tis_active = _is_active\n\t\n\tif(is_active): \n\t\tset_opacity(1)\n\t\tget_node(\"LineEdit\").grab_focus()\n\telse: \n\t\tset_opacity(0.3)\n#\t\tget_node(\"LineEdit\").set_focus_mode(0)\n\nfunc get_activity(): return is_active\n\nfunc _on_LineEdit_input_event( ev ):\n#\tprint(ev.is_echo())\n\t\n\tif(ev.is_action_pressed(\"ui_accept\") and ev.is_echo() == false):\n\t\tif(control_node == null): return print(\"ERROR @%s: no control_node found\" %self.get_name())\n\t\ttranslation_atempt = get_node(\"LineEdit\").get_text()\n\t\tcontrol_node.queue_next_panel(self)\n#\tif(InputEvent..is_key_pressed(KEY_RETURN) and ev.is_echo()): print(ev)\n\tpass # replace with function body\n"

[sub_resource type="Animation" id=26]

length = 1.0
loop = false
step = 0.1
tracks/0/type = "value"
tracks/0/path = NodePath("notebook_new_words:transform/pos")
tracks/0/interp = 1
tracks/0/imported = false
tracks/0/keys = { "times":FloatArray( 0, 0.7, 1 ), "transitions":FloatArray( 0.25, 0.25, 0.25 ), "update":0, "values":[ Vector2( 493.059, -314.978 ), Vector2( 493.059, 305.021 ), Vector2( 493.059, 305.021 ) ] }
tracks/1/type = "value"
tracks/1/path = NodePath("black_background:visibility/opacity")
tracks/1/interp = 1
tracks/1/imported = false
tracks/1/keys = { "times":FloatArray( 0.2, 0.8 ), "transitions":FloatArray( 1, 1 ), "update":0, "values":[ 0.0, 1.0 ] }

[node name="notebook_ui" type="Node2D"]

editor/display_folded = true
z/z = 3
script/script = SubResource( 24 )
word_panel = ExtResource( 1 )
root_node = NodePath("..")
panel = NodePath("notebook_new_words/panel")

[node name="black_background" type="Sprite" parent="."]

transform/pos = Vector2( 501.426, 297.54 )
transform/scale = Vector2( 3.55357, 2.10348 )
texture = ExtResource( 2 )
modulate = Color( 0.132813, 0.114655, 0.114655, 1 )
__meta__ = { "_edit_lock_":true }

[node name="notebook_new_words" type="Sprite" parent="."]

editor/display_folded = true
transform/pos = Vector2( 493.059, 305.021 )
transform/scale = Vector2( 0.47806, 0.47806 )
texture = ExtResource( 3 )

[node name="blocks" type="Sprite" parent="notebook_new_words"]

editor/display_folded = true
transform/pos = Vector2( -232.161, -274.664 )
transform/scale = Vector2( 1.39459, 0.457372 )
texture = ExtResource( 2 )
modulate = Color( 0.492188, 0.488823, 0.461426, 1 )
__meta__ = { "_edit_group_":true, "_edit_lock_":true }

[node name="blocks" type="Sprite" parent="notebook_new_words/blocks"]

transform/pos = Vector2( 0, 4.57349 )
texture = ExtResource( 2 )
modulate = Color( 0.542969, 0.538561, 0.50267, 1 )

[node name="blocks1" type="Sprite" parent="notebook_new_words/blocks"]

transform/pos = Vector2( 331.368, 2.23243 )
transform/scale = Vector2( 1.10018, 1.39988 )
texture = ExtResource( 2 )
modulate = Color( 0.550781, 0.547251, 0.518509, 1 )

[node name="word_panel" parent="notebook_new_words" instance=ExtResource( 1 )]

transform/pos = Vector2( -397.44, -355.604 )
script/script = SubResource( 25 )

[node name="panel" type="Panel" parent="notebook_new_words"]

visibility/self_opacity = 0.0
focus/ignore_mouse = false
focus/stop_mouse = true
size_flags/horizontal = 2
size_flags/vertical = 2
margin/left = -467.0
margin/top = -366.0
margin/right = 475.0
margin/bottom = 533.0

[node name="anim" type="AnimationPlayer" parent="."]

playback/process_mode = 1
playback/default_blend_time = 0.0
root/root = NodePath("..")
anims/appear = SubResource( 26 )
playback/active = true
playback/speed = 1.0
blend_times = [  ]
autoplay = ""


